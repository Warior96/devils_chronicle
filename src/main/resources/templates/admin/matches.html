<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">

<head th:insert="~{index :: head}"></head>

<body>
    <div th:insert="~{index :: navbar}"></div>

    <div class="min-vh-100">
        <!-- Page Header - Same as dashboard -->
        <div class="page-header">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-12 text-center">
                        <h1>
                            <i class="fas fa-futbol me-3"></i>
                            <span th:text="${title}">Matches Management</span>
                        </h1>
                        <p class="lead mb-0">
                            <i class="fa-solid fa-calendar-alt me-2"></i>
                            AC Milan matches from external API
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="container pt-2">
            <!-- Success/Error Messages - Same as dashboard -->
            <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show">
                <i class="fas fa-check-circle"></i>
                <span th:text="${successMessage}"></span>
            </div>

            <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show">
                <i class="fas fa-exclamation-circle"></i>
                <span th:text="${errorMessage}"></span>
            </div>

            <!-- Quick Actions Card -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="quick-actions-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="fas fa-bolt me-2"></i> Quick Actions
                            </h5>
                            <div class="row">
                                <div class="col-md-3 mb-2">
                                    <a href="/admin/dashboard" class="btn btn-info w-100">
                                        <i class="fas fa-arrow-left me-2"></i> Back to Dashboard
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <form th:action="@{/admin/matches/update}" method="post" class="d-inline w-100">
                                        <button type="submit" class="btn btn-primary w-100"
                                            onclick="return confirm('Update matches from API? This operation might take a few seconds.')">
                                            <i class="fas fa-sync-alt me-2"></i> Update from API
                                        </button>
                                    </form>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/articles" class="btn btn-warning w-100">
                                        <i class="fas fa-newspaper me-2"></i> View Articles
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/" class="btn btn-secondary w-100">
                                        <i class="fas fa-home me-2"></i> Back to Home
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Match Statistics -->
            <div class="row mb-4">
                <!-- Wins -->
                <div class="col-md-3">
                    <div class="stats-card accepted-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>Wins</h6>
                                <h3 id="winsCount">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-trophy fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Draws -->
                <div class="col-md-3">
                    <div class="stats-card pending-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>Draws</h6>
                                <h3 id="drawsCount">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-equals fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Losses -->
                <div class="col-md-3">
                    <div class="stats-card rejected-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>Losses</h6>
                                <h3 id="lossesCount">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-times-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Total Matches -->
                <div class="col-md-3">
                    <div class="stats-card category-accordion">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6>Total Matches</h6>
                                <h3 th:text="${#lists.size(matches)}">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-list fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Matches List Section -->
            <div class="row">
                <div class="col-12">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-table me-2"></i> Match List
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- Season 2025-26 Accordion -->
                            <div class="accordion dashboard-accordion">
                                <div class="accordion-item career-m">
                                    <h2 class="accordion-header accepted-accordion">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#season2025-26"
                                            aria-expanded="false">
                                            <h5 class="mb-0">
                                                <i class="fas fa-calendar-alt me-2"></i> Season 2025-26
                                            </h5>
                                        </button>
                                    </h2>
                                    <div id="season2025-26" class="accordion-collapse collapse">
                                        <div class="accordion-body">
                                            <div th:if="${#lists.isEmpty(matches)}" class="empty-state">
                                                <i class="fas fa-exclamation-circle"></i>
                                                <h5>No matches found</h5>
                                                <p>Try updating data from the API</p>
                                                <form th:action="@{/admin/matches/update}" method="post"
                                                    class="d-inline">
                                                    <button type="submit" class="btn btn-primary"
                                                        onclick="return confirm('Update matches from API?')">
                                                        <i class="fas fa-sync-alt me-2"></i> Update from API
                                                    </button>
                                                </form>
                                            </div>

                                            <div th:unless="${#lists.isEmpty(matches)}" class="table-responsive">
                                                <table class="table table-striped table-dark table-sm match-table">
                                                    <thead>
                                                        <tr>
                                                            <th class="ps-4">Date</th>
                                                            <th>Match</th>
                                                            <th class="text-center">Result</th>
                                                            <th class="text-center">Competition</th>
                                                            <th class="text-center">Status</th>
                                                            <th class="text-center">Venue</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr th:each="match : ${matches}">
                                                            <td class="ps-4">
                                                                <div class="match-date-time"
                                                                    th:text="${#temporals.format(match.date, 'dd/MM/yyyy')}">
                                                                </div>
                                                                <div class=""
                                                                    th:text="${#temporals.format(match.date, 'HH:mm')}">
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="match-teams">
                                                                    <span th:text="${match.homeTeam}"></span>
                                                                    <span class="match-vs">vs</span>
                                                                    <span th:text="${match.awayTeam}"></span>
                                                                </div>
                                                                <div th:if="${match.stadium}" class="stadium-info">
                                                                    <i class="fas fa-map-marker-alt me-1"></i>
                                                                    <span th:text="${match.stadium}"></span>
                                                                </div>
                                                            </td>
                                                            <td class="text-center">
                                                                <!-- WIN Badge -->
                                                                <span
                                                                    th:if="${match.score != null and matchService.getMilanResult(match) == 'WIN'}"
                                                                    class="badge status-accepted milan-result-win"
                                                                    th:text="${match.score}">
                                                                </span>
                                                                <!-- DRAW Badge -->
                                                                <span
                                                                    th:if="${match.score != null and matchService.getMilanResult(match) == 'DRAW'}"
                                                                    class="badge status-pending milan-result-draw"
                                                                    th:text="${match.score}">
                                                                </span>
                                                                <!-- LOSS Badge -->
                                                                <span
                                                                    th:if="${match.score != null and matchService.getMilanResult(match) == 'LOSS'}"
                                                                    class="badge status-rejected milan-result-loss"
                                                                    th:text="${match.score}">
                                                                </span>
                                                                <span th:unless="${match.score != null}"
                                                                    class="">-</span>
                                                            </td>
                                                            <td class="text-center">
                                                                <span class="badge bg-primary competitionBadge"
                                                                    th:text="${match.competition}"></span>
                                                            </td>
                                                            <td class="text-center">
                                                                <span th:if="${match.isPlayed}"
                                                                    class="badge status-accepted">
                                                                    <i class="fas fa-check me-1"></i> Played
                                                                </span>
                                                                <span th:unless="${match.isPlayed}"
                                                                    class="badge status-pending">
                                                                    <i class="fas fa-clock me-1"></i> Scheduled
                                                                </span>
                                                            </td>
                                                            <td class="text-center">
                                                                <span th:if="${match.isMilanHome}"
                                                                    class="badge badge-info">
                                                                    <i class="fas fa-home me-1"></i> Home
                                                                </span>
                                                                <span th:unless="${match.isMilanHome}"
                                                                    class="badge bg-secondary">
                                                                    <i class="fas fa-plane me-1"></i> Away
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API Information - Using request-info-card style -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="request-info-card">
                        <h3>
                            <i class="fas fa-info-circle me-2"></i> Information
                        </h3>
                        <p>
                            Match data is automatically updated every 6 hours from the Football-Data.org API.
                            If no API key is configured, sample data is used for testing purposes.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:insert="~{index :: footer}"></div>
    <div th:replace="~{index :: script}"></div>


</body>

</html>
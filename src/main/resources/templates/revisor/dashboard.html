<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">

<head th:insert="~{index :: head}"></head>

<body>
    <div th:insert="~{index :: navbar}"></div>

    <div class="min-vh-100">
        <!-- Page Header -->
        <div class="page-header">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-12 text-center">
                        <h1>
                            <i class="fas fa-search me-3"></i>
                            <span th:text="${title}">Revisor Dashboard</span>
                        </h1>
                        <p class="lead mb-0">
                            <i class="fa-solid fa-magnifying-glass me-2"></i>
                            Content review panel for Devil's Chronicle
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="container pt-2">
            <!-- Success Message -->
            <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show">
                <i class="fas fa-check-circle"></i>
                <span th:text="${successMessage}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Quick Actions Card -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="quick-actions-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="fas fa-bolt me-2"></i> Quick Actions
                            </h5>
                            <div class="row">
                                <div class="col-md-3 mb-2">
                                    <a href="/articles" class="btn btn-info w-100">
                                        <i class="fas fa-newspaper me-2"></i> View articles
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/categories" class="btn btn-warning w-100">
                                        <i class="fas fa-tags me-2"></i> Browse categories
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/articles/create" class="btn btn-success w-100">
                                        <i class="fas fa-plus me-2"></i> New article
                                    </a>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <a href="/" class="btn btn-secondary w-100">
                                        <i class="fas fa-home me-2"></i> Back to home
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Article Review Statistics -->
            <div class="row mb-4">
                <!-- Pending Articles -->
                <div class="col-md-4">
                    <div class="stats-card pending-card">
                        <div class="d-flex justify-content-between align-items-center c-white">
                            <div>
                                <h5>Articles to be revised</h5>
                                <h3 th:text="${#lists.size(pendingArticles)}">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-clock fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Accepted Articles -->
                <div class="col-md-4">
                    <div class="stats-card accepted-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h5>Accepted articles</h5>
                                <h3 th:text="${#lists.size(acceptedArticles)}">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-check-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Rejected Articles -->
                <div class="col-md-4">
                    <div class="stats-card rejected-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h5>Rejected articles</h5>
                                <h3 th:text="${#lists.size(rejectedArticles)}">0</h3>
                            </div>
                            <div>
                                <i class="fas fa-times-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Article review sections -->
            <div class="row">
                <div class="col-12">
                    <div class="accordion-container">
                        <div class="accordion dashboard-accordion">
                            <!-- Pending Articles Accordion -->
                            <div class="accordion-item career-m">
                                <h2 class="accordion-header pending-accordion">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#pendingArticles" aria-expanded="false">
                                        <div class="d-flex align-items-center">
                                            <i class="fas fa-clock me-2"></i>
                                            <h5 class="mb-0 me-3">Articles to be revised</h5>
                                        </div>
                                    </button>
                                </h2>
                                <div id="pendingArticles" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <div th:if="${#lists.isEmpty(pendingArticles)}" class="empty-state">
                                            <i class="fas fa-clock"></i>
                                            <h5>No articles to be revised</h5>
                                            <p class="mb-0">All articles have been reviewed</p>
                                        </div>
                                        <div th:unless="${#lists.isEmpty(pendingArticles)}">
                                            <div class="table-responsive">
                                                <table class="table table-striped table-dark table-sm">
                                                    <thead>
                                                        <tr>
                                                            <th class="text-center">ID</th>
                                                            <th>Title</th>
                                                            <th>Subtitle</th>
                                                            <th>Category</th>
                                                            <th class="text-center">Details</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr th:each="article : ${pendingArticles}">
                                                            <td class="text-center" th:text="${article.id}"></td>
                                                            <td th:text="${article.title}"></td>
                                                            <td th:text="${article.subtitle}"></td>
                                                            <td>
                                                                <span th:if="${article.category}"
                                                                    class="badge bg-warning text-dark requestedRole"
                                                                    th:text="${article.category.name}"></span>
                                                                <span th:unless="${article.category}"
                                                                    class="badge bg-secondary">No category</span>
                                                            </td>
                                                            <td class="text-center">
                                                                <a th:href="@{/articles/revisor/detail/{id}(id=${article.id})}"
                                                                    class="btn btn-sm btn-outline-info me-2"
                                                                    title="View Details">
                                                                    <i class="fas fa-eye"></i> Review
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Accepted Articles Accordion -->
                            <div class="accordion-item career-m">
                                <h2 class="accordion-header accepted-accordion">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#acceptedArticles" aria-expanded="false">
                                        <i class="fas fa-check-circle me-2"></i>
                                        <h5 class="mb-0">Accepted articles</h5>
                                    </button>
                                </h2>
                                <div id="acceptedArticles" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <div th:if="${#lists.isEmpty(acceptedArticles)}" class="empty-state">
                                            <i class="fas fa-check-circle"></i>
                                            <h5>No accepted articles</h5>
                                            <p class="mb-0">Your approved articles will appear here</p>
                                        </div>
                                        <div th:unless="${#lists.isEmpty(acceptedArticles)}" class="table-responsive">
                                            <table class="table table-striped table-dark table-sm">
                                                <thead>
                                                    <tr>
                                                        <th class="text-center">ID</th>
                                                        <th>Title</th>
                                                        <th>Subtitle</th>
                                                        <th>Category</th>
                                                        <th class="text-center">Actions</th>
                                                        <th class="text-center">Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr th:each="article : ${acceptedArticles}">
                                                        <td class="text-center" th:text="${article.id}"></td>
                                                        <td th:text="${article.title}"></td>
                                                        <td th:text="${article.subtitle}"></td>
                                                        <td>
                                                            <span th:if="${article.category}"
                                                                class="badge bg-warning text-dark requestedRole"
                                                                th:text="${article.category.name}"></span>
                                                            <span th:unless="${article.category}"
                                                                class="badge bg-secondary">No category</span>
                                                        </td>
                                                        <td class="text-center">
                                                            <form
                                                                th:action="@{/articles/accept(action='reject', articleId=${article.id})}"
                                                                method="POST" class="d-inline">
                                                                <button type="submit" class="btn btn-sm btn-danger"
                                                                    onclick="return confirm('Reject this article?')" title="Reject Article">
                                                                    <i class="fas fa-times"></i> Reject
                                                                </button>
                                                            </form>
                                                        </td>
                                                        <td class="text-center">
                                                            <a th:href="@{/articles/revisor/detail/{id}(id=${article.id})}"
                                                                class="btn btn-sm btn-outline-info me-2"
                                                                title="View Details">
                                                                <i class="fas fa-eye"></i> View
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Rejected Articles Accordion -->
                            <div class="accordion-item career-m">
                                <h2 class="accordion-header rejected-accordion">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#rejectedArticles" aria-expanded="false">
                                        <i class="fas fa-times-circle me-2"></i>
                                        <h5 class="mb-0">Rejected articles</h5>
                                    </button>
                                </h2>
                                <div id="rejectedArticles" class="accordion-collapse collapse">
                                    <div class="accordion-body">
                                        <div th:if="${#lists.isEmpty(rejectedArticles)}" class="empty-state">
                                            <i class="fas fa-times-circle"></i>
                                            <h5>No rejected articles</h5>
                                            <p class="mb-0">Your rejected articles will appear here</p>
                                        </div>
                                        <div th:unless="${#lists.isEmpty(rejectedArticles)}" class="table-responsive">
                                            <table class="table table-striped table-dark table-sm">
                                                <thead>
                                                    <tr>
                                                        <th class="text-center">ID</th>
                                                        <th>Title</th>
                                                        <th>Subtitle</th>
                                                        <th>Category</th>
                                                        <th class="text-center">Actions</th>
                                                        <th class="text-center">Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr th:each="article : ${rejectedArticles}">
                                                        <td class="text-center" th:text="${article.id}"></td>
                                                        <td th:text="${article.title}"></td>
                                                        <td th:text="${article.subtitle}"></td>
                                                        <td>
                                                            <span th:if="${article.category}"
                                                                class="badge bg-warning text-dark requestedRole"
                                                                th:text="${article.category.name}"></span>
                                                            <span th:unless="${article.category}"
                                                                class="badge bg-secondary">No category</span>
                                                        </td>
                                                        <td class="text-center">
                                                            <form
                                                                th:action="@{/articles/accept(action='accept', articleId=${article.id})}"
                                                                method="POST" class="d-inline">
                                                                <button type="submit" class="btn btn-sm btn-success"
                                                                    onclick="return confirm('Accept this article?')" title="Accept Article">
                                                                    <i class="fas fa-check"></i> Accept
                                                                </button>
                                                            </form>
                                                        </td>
                                                        <td class="text-center">
                                                            <a th:href="@{/articles/revisor/detail/{id}(id=${article.id})}"
                                                                class="btn btn-sm btn-outline-info me-2"
                                                                title="View Details">
                                                                <i class="fas fa-eye"></i> View
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:insert="~{index :: footer}"></div>
    <div th:replace="~{index :: script}"></div>

</body>

</html>